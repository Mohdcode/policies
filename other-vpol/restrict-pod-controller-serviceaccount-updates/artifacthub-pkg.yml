name: restrict-pod-controller-serviceaccount-updates-vpol
version: 1.0.0
displayName: Restrict Pod Controller ServiceAccount Updates in ValidatingPolicy
description: >-
  ServiceAccounts which have the ability to edit/patch workloads which they created may potentially use that privilege to update to a different ServiceAccount with higher privileges. This policy, intended to be run in `enforce` mode, blocks updates to Pod controllers if those updates modify the serviceAccountName field. Updates to Pods directly for this field are not possible as it is immutable once set.
install: |-
  ```shell
  kubectl apply -f https://raw.githubusercontent.com/kyverno/policies/main/other-vpol/restrict-pod-controller-serviceaccount-updates/restrict-pod-controller-serviceaccount-updates.yaml
  ```
keywords:
  - kyverno
  - Other
  - ValidatingPolicy
readme: |
  ServiceAccounts which have the ability to edit/patch workloads which they created may potentially use that privilege to update to a different ServiceAccount with higher privileges. This policy, intended to be run in `enforce` mode, blocks updates to Pod controllers if those updates modify the serviceAccountName field. Updates to Pods directly for this field are not possible as it is immutable once set.
  
  Refer to the documentation for more details on Kyverno annotations: https://artifacthub.io/docs/topics/annotations/kyverno/
annotations:
  kyverno/category: "Other in Vpol"
  kyverno/kubernetesVersion: "1.30"
  kyverno/subject: "Pod"
digest: 51d9a05d9729f4538592e342ec4dc4acb961b63d98fb55044b9942c8a6abf161
createdAt: "2025-03-18T02:15:56Z"
